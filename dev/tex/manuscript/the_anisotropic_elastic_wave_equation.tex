%!TEX root = SISC_elastic_3d.tex
\section{The anisotropic elastic wave equation }
%We consider the time dependent anisotropic elastic wave equation in three dimensions. The problem is defined on a curvilinear domain ${\bf x}\in\Omega, {\bf x} = (x^{(1)},x^{(2)},x^{(3)})^T$ with a mesh refinement interface $\Gamma$.  We partition the domain $\Omega$ into two subdomains $\Omega^f$ and $\Omega^c$ such that the interface $\Gamma$ is aligned with a subdomain boundary, $\Omega = \Omega^f\cup\Omega^c$ and $\Gamma = \Omega^f\cap\Omega^c$. Denote ${\bf F} = (F_1,F_2,F_3)^T$ to be the three dimensional displacement vector on $\Omega^f$ and ${\bf C} = (C_1,C_2,C_3)^T$ to be the three dimensional displacement vector on $\Omega^c$. By introducing smooth one-to-one mapping
We consider the time dependent anisotropic elastic wave equation in three dimensional domain ${\bf x}\in\Omega$, where ${\bf x} = (x^{(1)},x^{(2)},x^{(3)})^T$. 
The domain $\Omega$ is partitioned into two subdomains $\Omega^f$ and $\Omega^c$ with an interface $\Gamma = \Omega^f\cup\Omega^c$. The material property is smooth in each subdomain, but may be discontinuous at the interface $\Gamma$. Without loss of generality, we assume that the wave speed is slower in $\Omega^f$ than in $\Omega^c$, which motivates to use a fine mesh in $\Omega^f$ and a coarse mesh in $\Omega^c$.  We further assume that both $\Omega^f$ and $\Omega^c$ have four, possibly curved, sides. By introducing smooth one-to-one mapping
\[{\bf x}^{f} = {\bf X}^{f}({\bf r}) : \Omega^f_r = [0,1]^3 \rightarrow \Omega^{f} \subset \mathbb{R}^3 \]
with ${\bf X}^{f}({\bf r}) = (x^{f,(1)}({\bf r}),x^{f,(2)}({\bf r}),x^{f,(3)}({\bf r}))^T, {\bf r} = (r^{1},r^{(2)},r^{(3)})^T, 0\leq r^{(i)}\leq1, i = 1,2,3$
and smooth one-to-one mapping 
\[{\bf x}^{c} = {\bf X}^{c}({\bf r}) : \Omega^c_r = [0,1]^3 \rightarrow \Omega^{c} \subset \mathbb{R}^3\]
 with ${\bf X}^{c}({\bf r}) = (x^{c,(1)}({\bf r}),x^{c,(2)}({\bf r}),x^{c,(3)}({\bf r}))^T, {\bf r} = (r^{(1)},r^{(2)},r^{(3)})^T, 0\leq r^{(i)}\leq1, i = 1,2,3$. Note that $\Omega^f_r = \Omega^c_r$. To have a better understanding, we refer Figure \ref{section_discretization} as an illustration. Indeed, we want to mention that the interface $\Gamma$ corresponds to $r^{(3)} = 1$ for coarse domain $\Omega^c$ and $r^{(3)} = 0$ for fine domain $\Omega^f$, that is we assume the fine domain $\Omega^f$ is on the top of coarse domain $\Omega^c$ in this paper. Then the elastic wave equation in terms of dispalcements can be written in curvilinear coordinates as
\begin{align}\label{elastic_curvi}
	\rho^f\frac{\partial^2{\bf F}}{\partial^2 t} &= \frac{1}{J^f}\left[\partial_1(A_1^f\nabla{\bf F}) + \partial_2(A_2^f\nabla{\bf F}) +\partial_3(A_3^f\nabla{\bf F}) \right], \ \ \  {\bf r}\in\Omega^f_r,\ \ \  t\geq0,\nonumber\\
	\rho^c\frac{\partial^2{\bf C}}{\partial^2 t} &= \frac{1}{J^c}\left[\partial_1(A_1^c\nabla{\bf C}) + \partial_2(A_2^c\nabla{\bf C}) +\partial_3(A_3^c\nabla{\bf C}) \right],\ \ \  {\bf r}\in\Omega^c_r,\ \ \  t\geq0,
\end{align}
where $\rho^f$ and $\rho^c$ are density functions for fine domian $\Omega^f$ and coarse domian $\Omega^c$ respectively, and $\partial_i = \frac{\partial}{\partial r_i}$, $\nabla = (\partial_1,\partial_2,\partial_3)$.  For the rest of paper, we use notation $\{\cdot,\cdot\}$ to represent the componentwise identities. Here,
\begin{align*} 
	A_1^{\{f,c\}}\nabla\{{\bf F}, {\bf C}\} &:= N_{11}^{\{f,c\}}\partial_1\{{\bf F}, {\bf C}\} + N_{12}^{\{f,c\}}\partial_2\{{\bf F}, {\bf C}\} + N_{13}^{\{f,c\}}\partial_3\{{\bf F}, {\bf C}\}, \\
	A_2^{\{f,c\}}\nabla\{{\bf F}, {\bf C}\} &:= N_{21}^{\{f,c\}}\partial_1\{{\bf F}, {\bf C}\} + N_{22}^{\{f,c\}}\partial_2\{{\bf F}, {\bf C}\} + N_{23}^{\{f,c\}}\partial_3\{{\bf F}, {\bf C}\}, \\
	A_3^{\{f,c\}}\nabla\{{\bf F}, {\bf C}\} &:= N_{31}^{\{f,c\}}\partial_1\{{\bf F}, {\bf C}\} + N_{32}^{\{f,c\}}\partial_2\{{\bf F}, {\bf C}\} + N_{33}^{\{f,c\}}\partial_3\{{\bf F}, {\bf C}\},
\end{align*}
with
\begin{equation}\label{N_definition}
	N_{ij}^{\{f,c\}} = J^{\{f,c\}}\big(O_i\big)^TM^{\{f,c\}}O_j, \ \ i,j = 1,2,3.
\end{equation}
Here, 
\[ O_{1}^T = \left(\begin{array}{cccccc}
1 & 0 & 0 &0 & 0 & 0\\
0 & 0 & 0 &0 & 0 & 1\\
0 & 0 & 0 &0 & 1 & 0\end{array}\right),  O_{2}^T = \left(\begin{array}{cccccc}
0 & 0 & 0 &0 & 0 & 1\\
0 & 1 & 0 &0 & 0 & 0\\
0 & 0 & 0 &1 & 0 & 0\end{array}\right),  O_{3}^T = \left(\begin{array}{cccccc}
0 & 0 & 0 &0 & 1 & 0\\
0 & 0 & 0 &1 & 0 & 0\\
0 & 0 & 1 &0 & 0 & 0\end{array}\right),\]
and $M^{\{f,c\}}$ are $6\times 6$ stiffness matrices and they are symmetric and positive definite. In particular, for isotropic elastic wave equation, we have
\[ M_{11}^{\{f,c\}} = \left(\begin{array}{ccc}
2\mu^{\{f,c\}}+\lambda^{\{f,c\}} & 0 & 0\\
0 & \mu^{\{f,c\}} & 0\\
0 & 0 & \mu^{\{f,c\}}\end{array}\right),\ \ \  M_{12}^{\{f,c\}} = \left(\begin{array}{ccc}
0 & \lambda^{\{f,c\}} & 0\\
\mu^{\{f,c\}} & 0 & 0\\
0 & 0 & 0\end{array}\right), \]
\begin{equation}\label{M_definition}
M_{22}^{\{f,c\}} = \left(\begin{array}{ccc}
\mu^{\{f,c\}} & 0 & 0\\
0 & 2\mu^{\{f,c\}}+\lambda^{\{f,c\}} & 0\\
0 & 0 & \mu^{\{f,c\}}\end{array}\right),\ \ \ M_{13}^{\{f,c\}} = \left(\begin{array}{ccc}
0 & 0 & \lambda^{\{f,c\}}\\
0 & 0 & 0\\
\mu^{\{f,c\}} & 0 & 0\end{array}\right),
\end{equation}
\[\ M_{33}^{\{f,c\}} = \left(\begin{array}{ccc}
\mu^{\{f,c\}} & 0 & \lambda^{\{f,c\}}\\
0 & \mu^{\{f,c\}} & 0\\
0 & 0 & 2\mu^{\{f,c\}}+\lambda^{\{f,c\}}\end{array}\right),\ \ \ M_{23}^{\{f,c\}} = \left(\begin{array}{ccc}
0 & 0 & 0\\
0 & 0 & \lambda^{\{f,c\}}\\
0 & \mu^{\{f,c\}} & 0\end{array}\right),\]
\[ M_{31}^{\{f,c\}} = (M_{13}^{\{f,c\}})^T, \ \ \  M_{32}^{\{f,c\}} =(M_{23}^{\{f,c\}})^T, \ \ \ M_{21}^{\{f,c\}} =(M_{12}^{\{f,c\}})^T.\]
Here, $\lambda^{\{f,c\}}$ and $\mu^{\{f,c\}}$ are the first and second L{\' {a}}me parameters respectively, which are determined by the properties of the materials. From the definitions of matrices $N_{ij}^{\{f,c\}}$ in (\ref{N_definition}), we have that $N_{ii}^{\{f,c\}}$, $i = 1,2,3$, are symmetric positive definite, and $N_{ij}^{\{f,c\}}=\big(N_{ji}^{\{f,c\}}\big)^T$, $i,j=1,2,3$. The Jacobian of transformation is $J^{\{f,c\}} =$ det$\left({\bf a}^{\{f,c\}}_1,{\bf a}^{\{f,c\}}_2,{\bf a}^{\{f,c\}}_3\right)$, $0<J^{\{f,c\}}<\infty$, with the derivative of the forward mapping, 
\begin{equation}\label{forward_map}
{\bf a}_k^{\{f,c\}} := \partial_k{\bf x}^{\{f,c\}}  = \left(\frac{\partial x^{\{f,c\},(1)}}{\partial r^{k}},\frac{\partial x^{\{f,c\},(2)}}{\partial r^{k}},\frac{\partial x^{\{f,c\},(3)}}{\partial r^{k}}\right)^T,\ \ \ \ k = 1,2,3,
\end{equation}
and the backward mapping,
\begin{equation}\label{backward_map}
{\bf a}^{\{f,c\},k} := \nabla_x^{\{f,c\}} r^{k} = \left(\frac{\partial r^{k}}{\partial x^{\{f,c\},(1)}},\frac{\partial r^{k}}{\partial x^{\{f,c\},(2)}},\frac{\partial r^{k}}{\partial x^{\{f,c\},(3)}}\right)^T := \left(\xi_{1k}^{\{f,c\}},\xi_{2k}^{\{f,c\}},\xi_{3k}^{\{f,c\}}\right)^T,\ \ \ k = 1,2,3.
\end{equation}
 The metric relation between (\ref{forward_map}) and (\ref{backward_map}) is given by \cite{thompson1985numerical},
\begin{equation*}
{\bf a}^{\{f,c\},i} = \frac{1}{J^{\{f,c\}}}\left({\bf a}_j^{\{f,c\}}\times{\bf a}_k^{\{f,c\}}\right), \ \ \ (i,j,k) \ \mbox{cycle}.
\end{equation*}
Denote the unit outward normal ${\bf n}_i^{\{f,c\},\pm} = (n_i^{\{f,c\},\pm,1},n_i^{\{f,c\},\pm,2},n_i^{\{f,c\},\pm,3})$, $i = 1,2,3$, for the boundaries of $i'$th direction on subdomain $\Omega^{\{f,c\}}$, then
\begin{align}\label{outward_normal}
{\bf n}_i^{\{f,c\},\pm} &:= (n^{\{f,c\},\pm,1}_i,n^{\{f,c\},\pm,2}_i,n^{\{f,c\},\pm,3}_i)^T = \pm \frac{\nabla_x^{\{f,c\}} r^{i}}{\left|\nabla_x^{\{f,c\}} r^{i}\right|} \nonumber\\
&= \pm\frac{ \left(\xi_{1i}^{\{f,c\}},\xi_{2i}^{\{f,c\}},\xi_{3i}^{\{f,c\}}\right)^T}{\sqrt{(\xi_{1i}^{\{f,c\}})^2+(\xi_{2i}^{\{f,c\}})^2+(\xi_{3i}^{\{f,c\}})^2}},
\end{align}
here, $'+'$ corresponds to $r^{i} = 1$ and $'-'$ corresponds to $r^{i} = 0$.  

At the interface $\Gamma$, suitable physical interface conditions are the continuity of the traction vectors and the continuity of the displacement vectors 
\begin{equation}\label{interface_cond}
\frac{A_3^f\nabla{\bf F}}{J^f|\nabla_x^f r^{(3)}|}  = \frac{A_3^c\nabla{\bf C}}{J^c\left|\nabla_x^c r^{(3)}\right|}, \ \ \ \ {\bf F} = {\bf C}.
\end{equation}
Together with suitable physical boundary conditions, the problem (\ref{elastic_curvi}, \ref{interface_cond}) is well-posed \cite{duru2014stable, petersson2015wave}.


