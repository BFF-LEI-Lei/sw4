%!TEX root = SISC_elastic_3d.tex
\section{Introduction}
Seismic wave propagation has important applications in earthquake simulation and forcasting, energy resources exploration, and underground motion analysis. In many practical problems, wave motion is governed by the three dimensional (3D) anisotropic elastic wave equations. The layered structure of the Earth gives rise to a piecewise smooth material property with discontinuities at internal interfaces, which are often curved in realistic models. Because of the heterogeneous material property and internal interfaces, the governing equations cannot be solved analytically, and it is necessary to use advanced numerical techniques to solve the seismic wave propagation problems.

When soving hyperbolic partial differential equations (PDEs), for computational efficiency, it is essential that the numerical methods are high order accurate (fourth order or higher). This is because high order methods have much smaller dispersion error than lower order methods, see the analysis of dispersion relation for first order hyperbolic PDEs \cite{Kreiss1972} and second order hyperbolic PDEs \cite{Hagstrom2012}. However, it is challenging to obtain high order accuracy in the presense of discontinuous material property and non-trivial geometry. 

Traditionally, the governing equations of seismic wave propagation are solved as a first order system, either in velocity-strain or velocity-stress formulation, which consists of nine equations. With the finite difference method, staggered grids are often used for first order systems, and recently the technique has been generalized to staggered curviliear grids for the wave equation \cite{OReilly2020}.

In this paper, we use another approach that discretizes the governing equations in second order form. Comparing with nine PDEs in a first order system, the second order formulation consists of only three PDEs in the displacement variables. In many cases, this could be a more effficient approach in terms of accuracy and memory usage. For spatial discretization, we consider the finite difference operators constructed in \cite{sjogreen2012fourth} that satisfy a summation-by-parts (SBP) principle. The SBP is a discrete analogue of the integration-by-parts, and is an important ingradient to obtain energy stability. 

In the SBP finite difference framework, a multi-block approach is often taken when the material property is discontinuous. That is, the domain is divided into subdomains such that the internal interfaces are aligned with the material discontinuities. SBP operators are then used independently in each subdomain for the spatial discretization of the governing equations. To patch subdomains together, physical interface conditions are imposed at internal interfaces. 


%There are two main methodologies to impose boundary and interface conditions in an SBP finite difference method. The  can be imposed weakly by using the simultaneous-approximation term (SAT) \cite{Carpenter1994}, which bears similarity with the discontinuous Galerkin method \cite{Gassner2013}. An SBP-SAT finite difference method has been developed to solve the elastic wave equation in \cite{Duru2014V}. Another approach is to impose boundary and interface conditions strongly by using ghost points, which is the approach taken in this paper. 

In \cite{petersson2015wave}, a fourth order SBP finite difference method is developed to solve the 3D elastic wave equation in heterogeneous smooth media, where topography in non-rectangular domains is resolved by using curvilinear meshes. The main objective of the present paper is to develop a fourth order method that solves the governing equations in piecewise smooth media, where material discontinuities occur at curved interfaces. This is motivated by the fact that in realistic models, material properties are only piecewise smooth with discontinuities, and it is important to obtain high order accuracy even at the material interfaces. A highlight of our method is that  mesh sizes in each subdomain can be chosen according to the velocity structure of the material property so that computational efficiency is maximized. In the context of seismic wave propagation, as going deeper in the Earth, the wave speed gets larger and the wavelength gets longer. Correspondingly, in our model, the mesh becomes coarser from one subdomain to the next one underneath. In this way, the number of grid points per wavelength can be kept almost the same in the entire domain. 

For mesh refinement interfaces, we have constructed fourth order interpolation and restriction operators to impose the interface conditions at the hanging nodes. These operators are compatible with the underlying SBP operators. With a fourth order predictor-corrector time integrator, the fully discrete discretization is energy conserving. 

The rest of the paper is organized as follows. In Sec. 2, we introduce the governing equations in curvilinear coordinates. The spatial discretization is presented in detail in Sec. 3. Particular emphasize is placed on the numerical coupling procedure at curved mesh refinement interfaces. In Sec. 4, we describe the temporal discretization, and present the fully discrete scheme. Numerical experiments are presented in Sec. 5 to verify the convergence rate of the proposed scheme and the energy conserving property. We also demonstrate that the mesh refinement interfaces do not introduce spurious wave reflections. In the end, we draw conclusion in Sec. 6. 
